<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>JarryLi&#39;s Blog | Modbus 协议开发 | JarryLi&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="/css/public.css" />
  <link rel="stylesheet" href="/css/layout.css" />
  <link rel="stylesheet" href="/css/iconfont.css" />
  <link rel="stylesheet" href="/css/nprogress.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" />
  <link rel="shortcut icon" href="/imgs/shortcut-icon.ico" type="image/x-icon">
  
  <script src="/js/nprogress.js"></script>


  <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
  <script>
    document.title = `JarryLi's Blog | Modbus 协议开发`
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div id="container" class="container w-100 vh-100">
    <header class="header">
  <div class="header-wrapper">
    <div class="header-left">
      <div class="header-search">
        <input id="search-input" type="text" class="header-search--input" placeholder="请输入要检索的文章标题" />
        <span id="search-btn" class="header-search--icon"><i class="iconfont icon-sousuo"></i></span>
      </div>
      <div id="search-layer" class="header-search--layer hidden">
        <p class="title">
          <span>以下是搜索内容：</span>
          <span id="close-layer-btn">关闭</span>
        </p>
        <ul>
        </ul>
      </div>
    </div>
    <div class="header-right">
      <ul class="header-menu">
        <li>
          <a href="/">
            <i class="header-menu--icon iconfont icon-shouye"></i>
            <span class="header-menu--span">首页</span>
          </a>
        </li>
        <li>
          <a href="/log">
            <i class="header-menu--icon iconfont icon-rizhi"></i>
            <span class="header-menu--span">日志</span>
          </a>
        </li>
        <li>
          <a href="/link">
            <i class="header-menu--icon iconfont icon-youqinglianjie"></i>
            <span class="header-menu--span">友情链接</span>
          </a>
        </li>
        <li>
          <a href="/about">
            <i class="header-menu--icon iconfont icon-guanyuwomen"></i>
            <span class="header-menu--span">关于我</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</header>

<script>
  const ipt = document.querySelector('#search-input')
  const btn = document.querySelector('#search-btn')
  const layer = document.querySelector('#search-layer')
  const posts = JSON.parse(`[{"title":"Android Studio配置阿里源及修改gradle包的位置","path":"2024/09/20/Android Studio配置阿里源及修改gradle包的位置/"},{"title":"C++ 11 类型转换","path":"2024/08/03/C++ 11 类型转换/"},{"title":"CLion通过SSH连接Linux","path":"2024/10/13/CLion通过SSH连接Linux/"},{"title":"常用的 Git 命令","path":"2024/09/02/Git常用命令/"},{"title":"I/O 复用","path":"2024/07/28/IO复用/"},{"title":"Modbus 功能码详解","path":"2024/08/10/Modbus功能码详解/"},{"title":"Modbus 协议开发","path":"2024/08/10/Modbus协议开发/"},{"title":"STM32F103C8T6(源码1-5)","path":"2024/09/17/STM32F103C8T6(源码1-5)/"},{"title":"git的基本操作","path":"2024/07/15/git/"},{"title":"Nginx 反向代理","path":"2024/07/14/Nginx反向代理/"},{"title":"libmodbus库的使用","path":"2024/08/14/libmodbus库的使用/"},{"title":"多种 I/O 函数","path":"2024/08/04/chapter13多种IO函数/"},{"title":"Shell脚本编程","path":"2024/09/20/shell脚本编程/"},{"title":"内存泄露检测","path":"2024/10/12/内存泄露检测/"},{"title":"域名及网络地址","path":"2024/07/17/域名及网络地址/"},{"title":"多线程和线程同步","path":"2024/10/15/多线程和线程同步/"},{"title":"套接字的多种可选项","path":"2024/07/17/套接字的多种可选项/"},{"title":"多进程服务器端","path":"2024/07/18/多进程服务器端/"},{"title":"序列化-protobuf","path":"2024/07/14/序列化-protobuf/"},{"title":"生成器使用","path":"2024/07/14/生成器使用/"},{"title":"进程间通信","path":"2024/07/23/进程间通信/"}]`)
  ipt.addEventListener('keyup', e => {
    if (e.key === 'Enter') {
      handleSearch()
    }
  })
  btn.addEventListener('click', () => {
    handleSearch()
  })

  document.querySelector('#close-layer-btn').addEventListener('click', () => {
    layer.classList.toggle('hidden')
  })

  function handleSearch() {
    if (ipt.value.trim() === '') {
      return
    }
    let html = ''
    const targetPosts = posts.filter(post => post.title.includes(ipt.value))
    targetPosts.forEach(post => {
      html += `
        <li>
          <div>
            <a href="/${post.path}">${post.title.replace(new RegExp(ipt.value), `<span>${ipt.value}</span>`)}</a>
          </div>
          <img src="${post.cover || '/imgs/default-cover.webp' }" />
        </li>
      `
    })
    if (html.trim () === '') {
      html += '<p class="empty">没有搜索到内容</p>'
    }
    layer.querySelector('ul').innerHTML = html
    layer.classList.remove('hidden')
  }
</script> 
    <section id="main" class="main">
      <div class="main-left-wrapper">
<div class="main-left">
  <div class="main-left--block">
    <div class="main-left--info">
      <img src="/imgs/avatar.jpg"" class="main-left--avatar" />
      <div class="main-left--intro">
        <p class="main-left--name">Cola.</p>
        <div class="main-left--tags">
          <span class="main-left--tag">中二</span>
          <span class="main-left--tag">宅</span>
        </div>
      </div>
    </div>
  
    <div>
      <div class="main-left--motto">
        <p>“花有重开日，人无再少年”</p>
        <p>“一个简单普通的男孩”</p>
      </div>
      <div class="main-left--github">
        <span class="line"></span>
        <a target="_blank" rel="noopener" href="https://github.com/Aizener"><i class="logo iconfont icon-github-fill"></i></a>
        <span class="line"></span>
      </div>
      <div class="main-left--statics">
        <a href="/categories">
          <div>
            <span>8</span>
            <span>分类</span>
          </div>
        </a>
        <a href="/tags">
          <div>
            <span>0</span>
            <span>标签</span>
          </div>
        </a>
        <a href="/archives">
          <div>
            <span>4 </span>
            <span>归档</span>
          </div>
        </a>
      </div>
    </div>
  </div>

  <div class="main-left--block">
    <ul class="main-left--menu">
      
        <li>
          <a href="/">
            <span class="header-menu--span">小站首页</span>
            <i class="header-menu--icon iconfont icon-shouye"></i>
          </a>
        </li>
      
        <li>
          <a href="/log">
            <span class="header-menu--span">个人日志</span>
            <i class="header-menu--icon iconfont icon-rizhi"></i>
          </a>
        </li>
      
        <li>
          <a href="/link">
            <span class="header-menu--span">友情链接</span>
            <i class="header-menu--icon iconfont icon-youqinglianjie"></i>
          </a>
        </li>
      
        <li>
          <a href="/about">
            <span class="header-menu--span">关于自己</span>
            <i class="header-menu--icon iconfont icon-guanyuwomen"></i>
          </a>
        </li>
      
        <li>
          <a href="/tools">
            <span class="header-menu--span">我的工具</span>
            <i class="header-menu--icon iconfont icon-gongju"></i>
          </a>
        </li>
      
    </ul>
  </div>

  <div class="main-left--block">
    <div class="main-left--site">
      <h5 class="main-left--title">
        <span>站点信息</span>
        <i class="iconfont icon-zhandian"></i>
      </h5>
      <p class="main-left--subtitle">
        <span>文章数目：</span>
        <span>21 篇</span>
      </p>
      <p class="main-left--subtitle">
        <span>最近动态：</span>
        <span>昨天</span>
      </p>
      <p class="main-left--subtitle">
        <span>上线时间：</span>
        <span>973天</span>
      </p>
    </div>
  </div>
</div></div>
      <div id="main-container" class="main-container">


  <div class="article-container">
  <div class="article">
    <h1 class="article-title">Modbus 协议开发</h1>
    <div class="article-info">
      <div class="article-info--item">
        <div class="article-info--info">
          <div class="article-info--categories">
            <span>分类：</span>
            <a class="category-link" href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a>
          </div>
          <div class="article-info--tags">
            <span>标签：</span>
            
          </div>
          <p class="article-info--date">日期：2024-08-10 18:34:03</p>
        </div>
        <img src="/imgs/default-cover.webp" alt="" class="article-cover">
      </div>
    </div>
    <article class="article-content">
      <h1 id="Modbus-协议开发"><a href="#Modbus-协议开发" class="headerlink" title="Modbus 协议开发"></a>Modbus 协议开发</h1><h2 id="1-Modbus-协议简介"><a href="#1-Modbus-协议简介" class="headerlink" title="1. Modbus 协议简介"></a>1. Modbus 协议简介</h2><p>• Modbus协议，是单主&#x2F;多从协议</p>
<p>• 同一时刻，只能有一个主设备，一个或多个从设备（最多247个）</p>
<p>• 只能由主设备发起通信请求</p>
<p>• 从设备没有收到主设备的请求时，不能主动发送数据</p>
<p>• 只能在主设备和从设备之间通信，从设备之间不能通信</p>
<p>• 主设备只能同时启动一个modbus访问事务（即一个事务处理完之后，才能发起另一个事务）</p>
<p>• 主设备和从设备之间，有两种通信方式：单播模式、广播模式</p>
<h2 id="2-单播模式和广播模式"><a href="#2-单播模式和广播模式" class="headerlink" title="2. 单播模式和广播模式"></a>2. 单播模式和广播模式</h2><h3 id="2-1-单播模式"><a href="#2-1-单播模式" class="headerlink" title="2.1 单播模式"></a>2.1 单播模式</h3><table>
<thead>
<tr>
<th>从设备地址(1-247)</th>
<th>功能码</th>
<th>数据段(从设备内的寄存器地址，寄存器数量)</th>
<th>差错校验</th>
</tr>
</thead>
</table>
<p><strong>数据段：</strong>可以用来表示从“哪个寄存器”（2个字节）开始读取语句，以及要读取的”寄存器数量“（2个字节）</p>
<p><strong>数据段的长度：</strong>是可变的，某些功能码，数据段是空的</p>
<h4 id="2-1-1-请求报文实例"><a href="#2-1-1-请求报文实例" class="headerlink" title="2.1.1 请求报文实例"></a>2.1.1 请求报文实例</h4><p>​	从设备地址为1，需要获取从设备的指定”输入寄存器“（寄存器的PLC地址为：30001），在modbus RTU模式下，查询帧为：</p>
<table>
<thead>
<tr>
<th>0x01</th>
<th>0x04</th>
<th>0x00 0x00    0x00 0x01</th>
<th>0x31</th>
</tr>
</thead>
</table>
<p>单播模式中，主设备发送请求报文后，指定的从设备发送一个响应报文。从设备的地址范围是1~247，主设备本身不使用设备地址。</p>
<h3 id="2-2-广播模式"><a href="#2-2-广播模式" class="headerlink" title="2.2 广播模式"></a>2.2 广播模式</h3><p>广播模式中，主设备向所有设备发送请求指令（注意，只有一个请求报文，设备地址是0），所有的从设备收到广播请求后，执行相应的处理，但是不返回任何报文。</p>
<h2 id="3-Modbus寄存器"><a href="#3-Modbus寄存器" class="headerlink" title="3. Modbus寄存器"></a>3. Modbus寄存器</h2><p>modbus寄存器：是指从设备具体的”物理寄存器“，也可能只是从设备的一块内存区域。</p>
<h3 id="3-1-modbus寄存器的种类"><a href="#3-1-modbus寄存器的种类" class="headerlink" title="3.1 modbus寄存器的种类"></a>3.1 modbus寄存器的种类</h3><h4 id="3-1-1-线圈状态寄存器（读-写）"><a href="#3-1-1-线圈状态寄存器（读-写）" class="headerlink" title="3.1.1 线圈状态寄存器（读&#x2F;写）"></a>3.1.1 线圈状态寄存器（读&#x2F;写）</h4><p>实际上就可以类比为开关量（继电器状态），每一个bit对应一个信号的开关状态，所以一个byte就可以同时控制8路的信号。</p>
<p>比如控制外部8路io的高低</p>
<p><img src="/../picture/%E5%B5%8C%E5%85%A5%E5%BC%8F/assets/image-20240810101852374.png" alt="image-20240810101852374"  data-tag='post-image' loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h4 id="3-1-2-离散输入状态寄存器（只读）"><a href="#3-1-2-离散输入状态寄存器（只读）" class="headerlink" title="3.1.2 离散输入状态寄存器（只读）"></a>3.1.2 离散输入状态寄存器（只读）</h4><p>离散输入寄存器就相当于线圈寄存器的只读模式，也是每个bit表示一个开关量，而他的开关量只能读取输入的开关信号，是不能够写的。</p>
<p>比如：使用离散输入状态寄存器，读取拨码开关的”开关状态“。</p>
<p><img src="/../picture/%E5%B5%8C%E5%85%A5%E5%BC%8F/assets/image-20240810102201886.png" alt="image-20240810102201886"  data-tag='post-image' loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h4 id="3-1-3-保持寄存器（读-写）"><a href="#3-1-3-保持寄存器（读-写）" class="headerlink" title="3.1.3 保持寄存器（读&#x2F;写）"></a>3.1.3 保持寄存器（读&#x2F;写）</h4><p>可以通过命令读取写的寄存器，通常是一些功能控制寄存器或者输出寄存器。</p>
<p>无符号双字节整形（unsigned short）</p>
<p>比如：步进电机控制器中，用来控制电机旋转多少角度的寄存器。</p>
<p><img src="/../picture/%E5%B5%8C%E5%85%A5%E5%BC%8F/assets/image-20240810102511668.png" alt="image-20240810102511668"  data-tag='post-image' loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h4 id="3-1-4-输入寄存器（只读）"><a href="#3-1-4-输入寄存器（只读）" class="headerlink" title="3.1.4 输入寄存器（只读）"></a>3.1.4 输入寄存器（只读）</h4><p>只能读不能写，无符号双字节整形（unsigned short）</p>
<p>通常是状态寄存器或者是输入结果寄存器等。</p>
<p>输入是模拟量的输入。</p>
<p>比如：模拟量输入</p>
<p><img src="/../picture/%E5%B5%8C%E5%85%A5%E5%BC%8F/assets/image-20240810102714167.png" alt="image-20240810102714167"  data-tag='post-image' loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="3-2-Modbus寄存器的地址"><a href="#3-2-Modbus寄存器的地址" class="headerlink" title="3.2 Modbus寄存器的地址"></a>3.2 Modbus寄存器的地址</h3><table>
<thead>
<tr>
<th>寄存器种类</th>
<th>寄存器PLC地址</th>
<th>寄存器Modbus协议地址</th>
<th>简称</th>
<th>读写状态</th>
</tr>
</thead>
<tbody><tr>
<td>线圈状态</td>
<td>00001 ~ 09999</td>
<td>0000H ~ FFFFH</td>
<td>0x</td>
<td>可读可写</td>
</tr>
<tr>
<td>离散输入状态</td>
<td>10001 ~ 19999</td>
<td>0000H ~ FFFFH</td>
<td>1x</td>
<td>只读</td>
</tr>
<tr>
<td>输入寄存器</td>
<td>30001 ~ 39999</td>
<td>0000H ~ FFFFH</td>
<td>3x</td>
<td>只写</td>
</tr>
<tr>
<td>保持寄存器</td>
<td>40001 ~ 49999</td>
<td>0000H ~ FFFFH</td>
<td>4x</td>
<td>可读可写</td>
</tr>
</tbody></table>
<h2 id="4-Modbus串行消息帧格式"><a href="#4-Modbus串行消息帧格式" class="headerlink" title="4. Modbus串行消息帧格式"></a>4. Modbus串行消息帧格式</h2><p>在串口通道上，modbus协议有两种帧格式：</p>
<p>• modbus ASCII 模式</p>
<p>• modbus RTU 模式</p>
<h3 id="4-1-Modbus-ASCII-消息帧格式"><a href="#4-1-Modbus-ASCII-消息帧格式" class="headerlink" title="4.1 Modbus ASCII 消息帧格式"></a>4.1 Modbus ASCII 消息帧格式</h3><p>消息中的没个8bit的字节数据，用对应的两个ASCII字符发送。</p>
<p><strong>例如：</strong></p>
<p>一个字节的数据：0x5B，就使用’5’和’B’传输，</p>
<p>‘5’对应的ASCII码值是 0x35</p>
<p>‘B’对应的ASCII码值是 0x42</p>
<p>所以使用0x35 0x42这两个字节传输</p>
<p><strong>帧格式：</strong></p>
<table>
<thead>
<tr>
<th>起始（帧头）</th>
<th>地址（从设备地址）</th>
<th>功能代码</th>
<th>数据</th>
<th>LRC校验</th>
<th>结束（帧尾）</th>
</tr>
</thead>
<tbody><tr>
<td>1字节</td>
<td>2字节</td>
<td>2字节</td>
<td>0 - 2*252 字节</td>
<td>2字节</td>
<td>2字节</td>
</tr>
<tr>
<td>0x3A（字符’:’）</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>0x0D 0x0A（回车 换行）</td>
</tr>
</tbody></table>
<p>（1）当网络上的modbus设备检测到0x3A(字符’:’)时，每个设备进入解码状态，并检测下一字段，是否是发给自己的。</p>
<p>（2）字符的发送间隔时间不超过1秒</p>
<p><strong>优缺点：</strong></p>
<p>更容易调试。</p>
<p>数据传输速度比较慢，不适合高速通信，适合与ASCII码有关的设备之间进行通信。</p>
<h3 id="4-2-Modbus-RTU-消息帧格式"><a href="#4-2-Modbus-RTU-消息帧格式" class="headerlink" title="4.2 Modbus RTU 消息帧格式"></a>4.2 Modbus RTU 消息帧格式</h3><p>RTU模式中，每一帧的时间间隔（比如请求消息和响应消息），至少为3.5个字符时间（可以大于3.5）；</p>
<p>在同一帧报文内部，两个字符之间的时间间隔不能大于1.5个字符时间，否则直接将整个报文丢弃。</p>
<p><img src="/../picture/%E5%B5%8C%E5%85%A5%E5%BC%8F/assets/image-20240810163020348.png" alt="image-20240810163020348"  data-tag='post-image' loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<p>1个字符包含：</p>
<p>1个起始位，8位数据位，1位校验位（或者没有），1位停止位（一般有），共11位</p>
<p>3.8个字符：就是3.5 * 11 &#x3D; 38.5位</p>
<p>如果波特率是 9600b&#x2F;s，那么：(1000 &#x2F; 9600) * 38.5 &#x3D; 4.0104167ms</p>
<p><img src="/../picture/%E5%B5%8C%E5%85%A5%E5%BC%8F/assets/image-20240810163257877.png" alt="image-20240810163257877"  data-tag='post-image' loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="4-3-Modbus-地址域"><a href="#4-3-Modbus-地址域" class="headerlink" title="4.3 Modbus 地址域"></a>4.3 Modbus 地址域</h3><p>表示modbus从设备的地址：1 - 247</p>
<p>广播地址：0</p>
<p>从设备发送响应包时，地址不变（依旧是这个从设备的地址，和请求包的地址相同）</p>
<p>ASCII 模式中，地址是2个字节</p>
<p>RTU模式中，地址是1个字节</p>
<h3 id="4-4-Modbus-功能码"><a href="#4-4-Modbus-功能码" class="headerlink" title="4.4 Modbus 功能码"></a>4.4 Modbus 功能码</h3><p>1个字节，1-255</p>
<p>需要根据从设备寄存器类型，来选择合适的功能码。</p>
<p><strong>常用的功能码：</strong></p>
<table>
<thead>
<tr>
<th>代码</th>
<th>名称</th>
<th>位&#x2F;字操作</th>
<th>操作数量</th>
<th>寄存器PLC地址</th>
</tr>
</thead>
<tbody><tr>
<td>01</td>
<td>读线圈状态</td>
<td>位操作</td>
<td>单个或多个</td>
<td>00001 ~ 09999</td>
</tr>
<tr>
<td>02</td>
<td>读离散输入状态</td>
<td>字操作</td>
<td>单个或多个</td>
<td>10001 ~ 19999</td>
</tr>
<tr>
<td>03</td>
<td>读保存寄存器</td>
<td>字操作</td>
<td>单个或多个</td>
<td>40001 ~ 49999</td>
</tr>
<tr>
<td>04</td>
<td>读输入寄存器</td>
<td>字操作</td>
<td>单个或多个</td>
<td>30001 ~ 39999</td>
</tr>
<tr>
<td>05</td>
<td>写单个线圈</td>
<td>位操作</td>
<td>单个</td>
<td>00001 ~ 09999</td>
</tr>
<tr>
<td>06</td>
<td>写单个保持寄存器</td>
<td>字操作</td>
<td>单个</td>
<td>40001 ~ 49999</td>
</tr>
<tr>
<td>15</td>
<td>写多个线圈</td>
<td>位操作</td>
<td>多个</td>
<td>00001 ~ 09999</td>
</tr>
<tr>
<td>16</td>
<td>写多个保持寄存器</td>
<td>字操作</td>
<td>多个</td>
<td>40001 ~ 49999</td>
</tr>
</tbody></table>
<p>字操作的最小单位是两字节，位操作的最小单位是1位(bit)</p>
<h3 id="4-5-数据域"><a href="#4-5-数据域" class="headerlink" title="4.5 数据域"></a>4.5 数据域</h3><p>具体内容取决于功能码，以字节为单位，长度可变，对于某些功能码，数据域可以为空。</p>
<h3 id="4-6-校验域"><a href="#4-6-校验域" class="headerlink" title="4.6 校验域"></a>4.6 校验域</h3><p><strong>ASCII模式：</strong></p>
<p>2个字节，对整个报文执行“纵向冗余校验”（LRC）</p>
<p>校验内容不含帧头（冒号），帧尾（回车换行）</p>
<p>实际校验内容只有一个字节，因为使用ASCII模式，占用两个字节</p>
<p><strong>RTU模式：</strong></p>
<p>2个字节，对整个报文执行“循环冗余校验”（CRC-16）</p>
<p>纠错能力强</p>
<h2 id="5-大小端"><a href="#5-大小端" class="headerlink" title="5. 大小端"></a>5. 大小端</h2><p>大端序（BigEndian）：字数据的高字节存储在低地址中，低字节存储在高地址中。 </p>
<p>小端序（LittleEndian）：字数据的高字节存储在高地址中，低字节存储在低地址中。</p>
<p>例如：将<code>12345678h</code>写入<code>1000h</code>开始的内存中：</p>
<table>
<thead>
<tr>
<th>存放顺序</th>
<th>1000h</th>
<th>1001h</th>
<th>1002h</th>
<th>1003h</th>
</tr>
</thead>
<tbody><tr>
<td>大端</td>
<td>12h</td>
<td>34h</td>
<td>56h</td>
<td>78h</td>
</tr>
<tr>
<td>小端</td>
<td>78h</td>
<td>56h</td>
<td>34h</td>
<td>12h</td>
</tr>
</tbody></table>
<p>Modbus 协议本身不指定是使用大端序还是小端序。 在ModbusRTU模式下，常使用小端序来表示寄存器地址和数据。</p>

    </article>
  </div>
  <div class="article-catelogue">
    <div class="article-catelogue--wrapper">
      <div class="catelogue catelogue-1">
        <h3>目录</h3>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Modbus-%E5%8D%8F%E8%AE%AE%E5%BC%80%E5%8F%91"><span class="toc-number">1.</span> <span class="toc-text">Modbus 协议开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Modbus-%E5%8D%8F%E8%AE%AE%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1. Modbus 协议简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%8D%95%E6%92%AD%E6%A8%A1%E5%BC%8F%E5%92%8C%E5%B9%BF%E6%92%AD%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">2. 单播模式和广播模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%8D%95%E6%92%AD%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 单播模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">2.1.1 请求报文实例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%B9%BF%E6%92%AD%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 广播模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Modbus%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-number">1.3.</span> <span class="toc-text">3. Modbus寄存器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-modbus%E5%AF%84%E5%AD%98%E5%99%A8%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 modbus寄存器的种类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-%E7%BA%BF%E5%9C%88%E7%8A%B6%E6%80%81%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88%E8%AF%BB-%E5%86%99%EF%BC%89"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">3.1.1 线圈状态寄存器（读&#x2F;写）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-%E7%A6%BB%E6%95%A3%E8%BE%93%E5%85%A5%E7%8A%B6%E6%80%81%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88%E5%8F%AA%E8%AF%BB%EF%BC%89"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">3.1.2 离散输入状态寄存器（只读）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-%E4%BF%9D%E6%8C%81%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88%E8%AF%BB-%E5%86%99%EF%BC%89"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">3.1.3 保持寄存器（读&#x2F;写）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-4-%E8%BE%93%E5%85%A5%E5%AF%84%E5%AD%98%E5%99%A8%EF%BC%88%E5%8F%AA%E8%AF%BB%EF%BC%89"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">3.1.4 输入寄存器（只读）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-Modbus%E5%AF%84%E5%AD%98%E5%99%A8%E7%9A%84%E5%9C%B0%E5%9D%80"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 Modbus寄存器的地址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Modbus%E4%B8%B2%E8%A1%8C%E6%B6%88%E6%81%AF%E5%B8%A7%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.4.</span> <span class="toc-text">4. Modbus串行消息帧格式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-Modbus-ASCII-%E6%B6%88%E6%81%AF%E5%B8%A7%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 Modbus ASCII 消息帧格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Modbus-RTU-%E6%B6%88%E6%81%AF%E5%B8%A7%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 Modbus RTU 消息帧格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-Modbus-%E5%9C%B0%E5%9D%80%E5%9F%9F"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 Modbus 地址域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-Modbus-%E5%8A%9F%E8%83%BD%E7%A0%81"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4 Modbus 功能码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%E6%95%B0%E6%8D%AE%E5%9F%9F"><span class="toc-number">1.4.5.</span> <span class="toc-text">4.5 数据域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-%E6%A0%A1%E9%AA%8C%E5%9F%9F"><span class="toc-number">1.4.6.</span> <span class="toc-text">4.6 校验域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%A4%A7%E5%B0%8F%E7%AB%AF"><span class="toc-number">1.5.</span> <span class="toc-text">5. 大小端</span></a></li></ol></li></ol>
      </div>
      
        <div class="catelogue catelogue-2">
          
            <p>
              <span>上一篇：</span>
              <a href="/2024/08/10/Modbus功能码详解/">Modbus 功能码详解</a>
            </p>
           
          
            <p>
              <span>下一篇</span>
              <a href="/2024/08/04/chapter13多种IO函数/">多种 I/O 函数</a>
            </p>
          
        </div>
      
    </div>
  </div>
</div>
<script src="/js/prism.js"></script>

<script>
  $(document).on('pjax:complete', function() {
    const tocs = document.querySelector('.toc')
    const as = tocs ? tocs.querySelectorAll('a') : []
    as.forEach(a => {
      a.addEventListener('click', e => {
        const href = decodeURIComponent(a.href)
        href.search(/#(.*)/)
        const id = RegExp.$1
        const target = document.querySelector('#' + id)
        const top = target.offsetTop
        document.documentElement.scrollTo({
          top: top - 100,
          behavior: 'smooth'
        })
        e.preventDefault()
      })
    })
  })
</script> 

</div>
      <div class="main-right-wrapper"><div class="main-right">
  <div class="main-right--board">
    <div class="main-right--title">
      <h5>公告栏</h5>
      <i class="iconfont icon-gonggao"></i>
    </div>
    <div class="main-right--content">
      Hello~大噶好。唔系可乐爱宅着，欢迎你们来到我的博客小站，希望能在这里收获到有用的东西哦！ 
    </div>
  </div>

  <div id="aplayer" class="main-right--music"></div>

  <div class="backtop">
    <i class="iconfont icon-huidaodingbu"></i>
    <span>回到顶部</span>
  </div>

  <div class="main-right--site">
    <div class="main-right--power">
      <p>Power By <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo</a>.</p>
      <p>Theme：<a target="_blank" rel="noopener" href="https://github.com/Aizener/hexo-theme-cola">Cola.</a></p>
    </div>
    <p class="main-right--refer">浙公网安备 33010002000124号 </p>
  </div>
</div>

<script>
  const musics = JSON.parse(`[{"name":"安河桥","artist":"宋冬野","url":"http://ting6.yymp3.net:82/new25/songdongye/11.mp3","cover":"https://img2.baidu.com/it/u=1260056724,1076343118&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500"},{"name":"卡布达","artist":"暂无","url":"/music/kabuda.mp3","cover":"https://img2.baidu.com/it/u=705831265,2862720033&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500"}]`)
  const ap = new APlayer({
    container: document.querySelector('#aplayer'),
    audio: musics,
  })

  document.querySelector('.backtop').addEventListener('click', () => {
    document.documentElement.scrollTo({
      top: 0,
      behavior: 'smooth'
    })
  })
</script></div>
    </section>
    <footer class="footer">
</footer> 
  </div>

  <script>
    function initScroll () {
      const doc = document.documentElement
      const pageHeight = doc.offsetHeight
      const clientHeight = doc.clientHeight
      NProgress.configure({
        parent: 'body',
        showSpinner: false,
        minimum: 0,
      })
      document.addEventListener('scroll', () => {
        const scrollTop = doc.scrollTop
        let ratio = scrollTop / (pageHeight - clientHeight)
        ratio = ratio > .99 ? .99999 : ratio
        NProgress.set(ratio)
      })
    }
    window.onload = function () {
      initScroll()
    }
    // 对所有链接跳转事件绑定pjax容器container
    $(document).pjax('a[target!=_blank]', '#main-container', {fragment:'#main-container', timeout:8000})
    $(document).on('pjax:complete', function() {
      initScroll()
    })
  </script>
</body>
</html>